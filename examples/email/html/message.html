<html>
    <head>
        <title>Message</title>
        <script>
            window.addEventListener('load', function () {
                var info = browser.state.msgInfo;
                var query = browser.state.conn.fetch(info.id, {
                    request : {
                        headers : false,
                        body : "1"
                    }
                });
                query.on('message', function (body) {
                    body.on('data', function (chunk) {
                        info.body += chunk
                    });
                    body.on('end', function () {
                        document.getElementById('from')
                                .appendChild(document.createTextNode('From: ' + info.from));
                        document.getElementById('subject')
                                .appendChild(document.createTextNode('Subject: ' + info.subject));
                        document.getElementById('body')
                                .appendChild(document.createTextNode(info.body));
                    });
                });
            });
        </script>
    </head>
    <body>
        <div id='from'></div>
        <div id='subject'></div>
        <div id='body'></div>
        <a href='http://localhost:3001/email.html' id='inbox'>Back to Inbox</a>
    </body>
</html>
